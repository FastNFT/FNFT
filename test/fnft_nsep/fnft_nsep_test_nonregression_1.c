/*
 * This file is part of FNFT.
 *
 * FNFT is free software; you can redistribute it and/or
 * modify it under the terms of the version 2 of the GNU General
 * Public License as published by the Free Software Foundation.
 *
 * FNFT is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 * Contributors:
 * Sander Wahls (TU Delft) 2020.
 * Shrinivas Chimmalgi (TU Delft) 2020.
 */

#define FNFT_ENABLE_SHORT_NAMES
#include "fnft.h"
#include "fnft_nsep.h"
#include "fnft__errwarn.h"
#include "fnft__misc.h"
#ifdef DEBUG
#include <stdio.h>
#endif

INT fnft_nsep_test_nonregression_1()
{
    INT ret_code = SUCCESS;
    COMPLEX spines_exact[494] = {
        5.757910937445194e-02 + -1.052283661549899e+00*I,
        -2.720503413438606e-02 + -8.382690687781414e-01*I,
        -7.031490660794864e-01 + -2.088433147059387e-03*I,
        -7.031490660794986e-01 + 2.088433147029546e-03*I,
        6.875748278106636e-01 + -8.068130600907605e-03*I,
        6.875748278106600e-01 + 8.068130600909254e-03*I,
        -2.720503413438606e-02 + 8.382690687781414e-01*I,
        5.757910937445086e-02 + 1.052283661549898e+00*I,
        5.739589554080691e-02 + -1.052472249118422e+00*I,
        -2.697891021506038e-02 + -8.372104617550327e-01*I,
        -2.697891021506034e-02 + 8.372104617550327e-01*I,
        5.739589554080639e-02 + 1.052472249118422e+00*I,
        5.721416467456725e-02 + -1.052660999526810e+00*I,
        -2.675376039720981e-02 + -8.361450591309455e-01*I,
        -2.675376039720981e-02 + 8.361450591309454e-01*I,
        5.721416467456674e-02 + 1.052660999526811e+00*I,
        5.703390665302165e-02 + -1.052849895721825e+00*I,
        -2.652956279701268e-02 + -8.350727631544792e-01*I,
        -2.652956279701278e-02 + 8.350727631544792e-01*I,
        5.703390665302054e-02 + 1.052849895721826e+00*I,
        5.685511119315688e-02 + -1.053038921039292e+00*I,
        -2.630629496514150e-02 + -8.339934725208801e-01*I,
        -2.630629496514157e-02 + 8.339934725208803e-01*I,
        5.685511119315650e-02 + 1.053038921039292e+00*I,
        5.667776786354958e-02 + -1.053228059200983e+00*I,
        -2.608393388005451e-02 + -8.329070822543885e-01*I,
        -2.608393388005454e-02 + 8.329070822543887e-01*I,
        5.667776786354894e-02 + 1.053228059200984e+00*I,
        5.650186609588227e-02 + -1.053417294311218e+00*I,
        -2.586245593985927e-02 + -8.318134835849308e-01*I,
        -2.586245593985930e-02 + 8.318134835849306e-01*I,
        5.650186609588215e-02 + 1.053417294311219e+00*I,
        5.632739519610358e-02 + -1.053606610853200e+00*I,
        -2.564183695267463e-02 + -8.307125638187892e-01*I,
        -2.564183695267450e-02 + 8.307125638187891e-01*I,
        5.632739519610298e-02 + 1.053606610853200e+00*I,
        5.615434435522979e-02 + -1.053795993685117e+00*I,
        -2.542205212541097e-02 + -8.296042062028510e-01*I,
        -2.542205212541101e-02 + 8.296042062028512e-01*I,
        5.615434435523050e-02 + 1.053795993685117e+00*I,
        5.598270265979404e-02 + -1.053985428036016e+00*I,
        -2.520307605088745e-02 + -8.284882897820004e-01*I,
        -2.520307605088742e-02 + 8.284882897820004e-01*I,
        5.598270265979441e-02 + 1.053985428036016e+00*I,
        5.581245910192893e-02 + -1.054174899501487e+00*I,
        -2.498488269318975e-02 + -8.273646892491916e-01*I,
        -2.498488269318975e-02 + 8.273646892491915e-01*I,
        5.581245910192843e-02 + 1.054174899501487e+00*I,
        5.564360258910224e-02 + -1.054364394039155e+00*I,
        -2.476744537117338e-02 + -8.262332747877192e-01*I,
        -2.476744537117331e-02 + 8.262332747877192e-01*I,
        5.564360258910218e-02 + 1.054364394039155e+00*I,
        5.547612195351050e-02 + -1.054553897963990e+00*I,
        -2.455073674000656e-02 + -8.250939119051703e-01*I,
        -2.455073674000658e-02 + 8.250939119051705e-01*I,
        5.547612195350998e-02 + 1.054553897963991e+00*I,
        5.531000596111343e-02 + -1.054743397943508e+00*I,
        -2.433472877063540e-02 + -8.239464612584596e-01*I,
        -2.433472877063543e-02 + 8.239464612584598e-01*I,
        5.531000596111339e-02 + 1.054743397943507e+00*I,
        5.514524332034380e-02 + -1.054932880992783e+00*I,
        -2.411939272704558e-02 + -8.227907784693863e-01*I,
        -2.411939272704578e-02 + 8.227907784693866e-01*I,
        5.514524332034354e-02 + 1.054932880992783e+00*I,
        5.498182269046768e-02 + -1.055122334469389e+00*I,
        -2.390469914118949e-02 + -8.216267139300441e-01*I,
        -2.390469914118948e-02 + 8.216267139300439e-01*I,
        5.498182269046751e-02 + 1.055122334469389e+00*I,
        5.481973268962945e-02 + -1.055311746068194e+00*I,
        -2.369061778542329e-02 + -8.204541125973694e-01*I,
        -2.369061778542334e-02 + 8.204541125973698e-01*I,
        5.481973268962965e-02 + 1.055311746068194e+00*I,
        5.465896190255868e-02 + -1.055501103816096e+00*I,
        -2.347711764229742e-02 + -8.192728137761139e-01*I,
        -2.347711764229750e-02 + 8.192728137761143e-01*I,
        5.465896190255880e-02 + 1.055501103816096e+00*I,
        5.449949888797603e-02 + -1.055690396066655e+00*I,
        -2.326416687152287e-02 + -8.180826508893946e-01*I,
        -2.326416687152283e-02 + 8.180826508893944e-01*I,
        5.449949888797621e-02 + 1.055690396066655e+00*I,
        5.434133218567395e-02 + -1.055879611494677e+00*I,
        -2.305173277391688e-02 + -8.168834512359677e-01*I,
        -2.305173277391682e-02 + 8.168834512359676e-01*I,
        5.434133218567355e-02 + 1.055879611494677e+00*I,
        5.418445032329997e-02 + -1.056068739090720e+00*I,
        -2.283978175212010e-02 + -8.156750357332755e-01*I,
        -2.283978175212007e-02 + 8.156750357332755e-01*I,
        5.418445032329991e-02 + 1.056068739090721e+00*I,
        5.402884182284321e-02 + -1.056257768155585e+00*I,
        -2.262827926785087e-02 + -8.144572186452456e-01*I,
        -2.262827926785085e-02 + 8.144572186452455e-01*I,
        5.402884182284336e-02 + 1.056257768155584e+00*I,
        5.387449520682813e-02 + -1.056446688294741e+00*I,
        -2.241718979544181e-02 + -8.132298072937317e-01*I,
        -2.241718979544182e-02 + 8.132298072937317e-01*I,
        5.387449520682764e-02 + 1.056446688294741e+00*I,
        5.372139900422695e-02 + -1.056635489412755e+00*I,
        -2.220647677137654e-02 + -8.119926017523992e-01*I,
        -2.220647677137646e-02 + 8.119926017523991e-01*I,
        5.372139900422705e-02 + 1.056635489412755e+00*I,
        5.356954175609820e-02 + -1.056824161707685e+00*I,
        -2.199610253952110e-02 + -8.107453945217558e-01*I,
        -2.199610253952109e-02 + 8.107453945217558e-01*I,
        5.356954175609831e-02 + 1.056824161707684e+00*I,
        5.341891202095120e-02 + -1.057012695665479e+00*I,
        -2.178602829170768e-02 + -8.094879701839076e-01*I,
        -2.178602829170753e-02 + 8.094879701839076e-01*I,
        5.341891202095146e-02 + 1.057012695665478e+00*I,
        5.326949837985791e-02 + -1.057201082054368e+00*I,
        -2.157621400329241e-02 + -8.082201050355010e-01*I,
        -2.157621400329243e-02 + 8.082201050355010e-01*I,
        5.326949837985772e-02 + 1.057201082054368e+00*I,
        5.312128944130377e-02 + -1.057389311919276e+00*I,
        -2.136661836327972e-02 + -8.069415666971788e-01*I,
        -2.136661836327967e-02 + 8.069415666971789e-01*I,
        5.312128944130358e-02 + 1.057389311919276e+00*I,
        5.297427384579798e-02 + -1.057577376576239e+00*I,
        -2.115719869854626e-02 + -8.056521136977113e-01*I,
        -2.115719869854623e-02 + 8.056521136977113e-01*I,
        5.297427384579814e-02 + 1.057577376576240e+00*I,
        5.282844027024428e-02 + -1.057765267606848e+00*I,
        -2.094791089166031e-02 + -8.043514950308216e-01*I,
        -2.094791089166030e-02 + 8.043514950308216e-01*I,
        5.282844027024466e-02 + 1.057765267606849e+00*I,
        5.268377743207971e-02 + -1.057952976852729e+00*I,
        -2.073870929173406e-02 + -8.030394496825016e-01*I,
        -2.073870929173403e-02 + 8.030394496825016e-01*I,
        5.268377743208025e-02 + 1.057952976852729e+00*I,
        5.254027409318823e-02 + -1.058140496410042e+00*I,
        -2.052954661768044e-02 + -8.017157061264435e-01*I,
        -2.052954661768041e-02 + 8.017157061264434e-01*I,
        5.254027409318832e-02 + 1.058140496410043e+00*I,
        5.239791906360512e-02 + -1.058327818624034e+00*I,
        -2.032037385317920e-02 + -8.003799817849552e-01*I,
        -2.032037385317921e-02 + 8.003799817849553e-01*I,
        5.239791906360558e-02 + 1.058327818624033e+00*I,
        5.225670120500235e-02 + -1.058514936083630e+00*I,
        -2.011114013258001e-02 + -7.990319824524956e-01*I,
        -2.011114013258003e-02 + 7.990319824524956e-01*I,
        5.225670120500209e-02 + 1.058514936083630e+00*I,
        5.211660943398055e-02 + -1.058701841616071e+00*I,
        -1.990179261687493e-02 + -7.976714016786520e-01*I,
        -1.990179261687495e-02 + 7.976714016786521e-01*I,
        5.211660943398083e-02 + 1.058701841616071e+00*I,
        5.197763272516364e-02 + -1.058888528281611e+00*I,
        -1.969227635877909e-02 + -7.962979201070929e-01*I,
        -1.969227635877915e-02 + 7.962979201070928e-01*I,
        5.197763272516325e-02 + 1.058888528281612e+00*I,
        5.183976011410050e-02 + -1.059074989368267e+00*I,
        -1.948253415583838e-02 + -7.949112047666468e-01*I,
        -1.948253415583840e-02 + 7.949112047666467e-01*I,
        5.183976011410013e-02 + 1.059074989368267e+00*I,
        5.170298069999788e-02 + -1.059261218386621e+00*I,
        -1.927250639035443e-02 + -7.935109083102847e-01*I,
        -1.927250639035442e-02 + 7.935109083102846e-01*I,
        5.170298069999795e-02 + 1.059261218386622e+00*I,
        5.156728364826323e-02 + -1.059447209064707e+00*I,
        -1.906213085477433e-02 + -7.920966681973064e-01*I,
        -1.906213085477429e-02 + 7.920966681973065e-01*I,
        5.156728364826305e-02 + 1.059447209064707e+00*I,
        5.143265819289247e-02 + -1.059632955342935e+00*I,
        -1.885134256101388e-02 + -7.906681058135592e-01*I,
        -1.885134256101388e-02 + 7.906681058135592e-01*I,
        5.143265819289220e-02 + 1.059632955342934e+00*I,
        5.129909363869134e-02 + -1.059818451369105e+00*I,
        -1.864007353200242e-02 + -7.892248255239226e-01*I,
        -1.864007353200234e-02 + 7.892248255239227e-01*I,
        5.129909363869155e-02 + 1.059818451369104e+00*I,
        5.116657936334265e-02 + -1.060003691493480e+00*I,
        -1.842825257350686e-02 + -7.877664136506755e-01*I,
        -1.842825257350687e-02 + 7.877664136506756e-01*I,
        5.116657936334276e-02 + 1.060003691493480e+00*I,
        5.103510481931983e-02 + -1.060188670263939e+00*I,
        -1.821580502404718e-02 + -7.862924373706300e-01*I,
        -1.821580502404704e-02 + 7.862924373706304e-01*I,
        5.103510481931954e-02 + 1.060188670263940e+00*I,
        5.090465953567026e-02 + -1.060373382421193e+00*I,
        -1.800265248041834e-02 + -7.848024435230957e-01*I,
        -1.800265248041837e-02 + 7.848024435230957e-01*I,
        5.090465953567018e-02 + 1.060373382421194e+00*I,
        5.077523311964254e-02 + -1.060557822894088e+00*I,
        -1.778871249600493e-02 + -7.832959573198207e-01*I,
        -1.778871249600495e-02 + 7.832959573198207e-01*I,
        5.077523311964238e-02 + 1.060557822894089e+00*I,
        5.064681525820350e-02 + -1.060741986794971e+00*I,
        -1.757389824867894e-02 + -7.817724809469987e-01*I,
        -1.757389824867895e-02 + 7.817724809469986e-01*I,
        5.064681525820360e-02 + 1.060741986794971e+00*I,
        5.051939571941045e-02 + -1.060925869415148e+00*I,
        -1.735811817463111e-02 + -7.802314920482135e-01*I,
        -1.735811817463109e-02 + 7.802314920482136e-01*I,
        5.051939571941038e-02 + 1.060925869415147e+00*I,
        5.039296435367789e-02 + -1.061109466220406e+00*I,
        -1.714127556395583e-02 + -7.786724420758577e-01*I,
        -1.714127556395591e-02 + 7.786724420758577e-01*I,
        5.039296435367799e-02 + 1.061109466220406e+00*I,
        5.026751109491648e-02 + -1.061292772846627e+00*I,
        -1.692326811320915e-02 + -7.770947544969476e-01*I,
        -1.692326811320920e-02 + 7.770947544969476e-01*I,
        5.026751109491606e-02 + 1.061292772846628e+00*I,
        5.014302596157220e-02 + -1.061475785095473e+00*I,
        -1.670398742943969e-02 + -7.754978228374859e-01*I,
        -1.670398742943962e-02 + 7.754978228374858e-01*I,
        5.014302596157199e-02 + 1.061475785095473e+00*I,
        5.001949905755325e-02 + -1.061658498930147e+00*I,
        -1.648331847937260e-02 + -7.738810085474439e-01*I,
        -1.648331847937257e-02 + 7.738810085474440e-01*I,
        5.001949905755290e-02 + 1.061658498930147e+00*I,
        4.989692057305833e-02 + -1.061840910471246e+00*I,
        -1.626113897643496e-02 + -7.722436386660397e-01*I,
        -1.626113897643497e-02 + 7.722436386660398e-01*I,
        4.989692057305853e-02 + 1.061840910471246e+00*I,
        4.977528078531405e-02 + -1.062023015992681e+00*I,
        -1.603731869716722e-02 + -7.705850032642287e-01*I,
        -1.603731869716726e-02 + 7.705850032642287e-01*I,
        4.977528078531458e-02 + 1.062023015992681e+00*I,
        4.965457005920929e-02 + -1.062204811917689e+00*I,
        -1.581171871719741e-02 + -7.689043526381206e-01*I,
        -1.581171871719751e-02 + 7.689043526381206e-01*I,
        4.965457005920958e-02 + 1.062204811917688e+00*I,
        4.953477884785321e-02 + -1.062386294814911e+00*I,
        -1.558419055533359e-02 + -7.672008942233112e-01*I,
        -1.558419055533364e-02 + 7.672008942233113e-01*I,
        4.953477884785321e-02 + 1.062386294814911e+00*I,
        4.941589769304656e-02 + -1.062567461394559e+00*I,
        -1.535457521240425e-02 + -7.654737891957740e-01*I,
        -1.367530457150047e-02 + -6.726865106274814e-02*I,
        -1.367530457150054e-02 + 6.726865106274660e-02*I,
        -1.535457521240412e-02 + 7.654737891957742e-01*I,
        4.941589769304658e-02 + 1.062567461394560e+00*I,
        4.929791722567285e-02 + -1.062748308504663e+00*I,
        -1.512270208916417e-02 + -7.637221487198581e-01*I,
        -1.380466451013413e-02 + -9.905787753067870e-02*I,
        -1.380466451013449e-02 + 9.905787753067935e-02*I,
        -1.512270208916419e-02 + 7.637221487198583e-01*I,
        4.929791722567289e-02 + 1.062748308504664e+00*I,
        4.918082816601663e-02 + -1.062928833127386e+00*I,
        -1.488838776482509e-02 + -7.619450297980008e-01*I,
        -1.393714915315911e-02 + -1.228786773400963e-01*I,
        -1.393714915315924e-02 + 1.228786773400962e-01*I,
        -1.488838776482516e-02 + 7.619450297980008e-01*I,
        4.918082816601639e-02 + 1.062928833127387e+00*I,
        4.906462132400462e-02 + -1.063109032375428e+00*I,
        -1.465143461441471e-02 + -7.601414306697039e-01*I,
        -1.407295305716843e-02 + -1.427844347306688e-01*I,
        -1.407295305716854e-02 + 1.427844347306688e-01*I,
        -1.465143461441469e-02 + 7.601414306697039e-01*I,
        4.906462132400442e-02 + 1.063109032375428e+00*I,
        4.894928759938982e-02 + -1.063288903488493e+00*I,
        -1.441162923915341e-02 + -7.583102856990382e-01*I,
        -1.421228636220573e-02 + -1.602478754656153e-01*I,
        -1.421228636220567e-02 + 1.602478754656149e-01*I,
        -1.441162923915349e-02 + 7.583102856990382e-01*I,
        4.894928759939005e-02 + 1.063288903488492e+00*I,
        4.883481798186062e-02 + -1.063468443829860e+00*I,
        -1.416874067910384e-02 + -7.564504596800840e-01*I,
        -1.435537659654616e-02 + -1.760040304868169e-01*I,
        -1.435537659654594e-02 + 1.760040304868161e-01*I,
        -1.416874067910389e-02 + 7.564504596800840e-01*I,
        4.883481798186073e-02 + 1.063468443829860e+00*I,
        4.872120355109302e-02 + -1.063647650882992e+00*I,
        -1.392251837137189e-02 + -7.545607414779678e-01*I,
        -1.450247073453586e-02 + -1.904832073582035e-01*I,
        -1.450247073453587e-02 + 1.904832073582036e-01*I,
        -1.392251837137190e-02 + 7.545607414779679e-01*I,
        4.872120355109319e-02 + 1.063647650882993e+00*I,
        4.860843547674879e-02 + -1.063826522248253e+00*I,
        -1.367268980977095e-02 + -7.526398369091705e-01*I,
        -1.465383755168550e-02 + -2.039634673909939e-01*I,
        -1.465383755168536e-02 + 2.039634673909939e-01*I,
        -1.367268980977097e-02 + 7.526398369091705e-01*I,
        4.860843547674872e-02 + 1.063826522248252e+00*I,
        4.849650501841170e-02 + -1.064005055639677e+00*I,
        -1.341895785278719e-02 + -7.506863607478954e-01*I,
        -1.480977033030260e-02 + -2.166371236816660e-01*I,
        -1.480977033030250e-02 + 2.166371236816660e-01*I,
        -1.341895785278716e-02 + 7.506863607478954e-01*I,
        4.849650501841155e-02 + 1.064005055639677e+00*I,
        4.838540352547808e-02 + -1.064183248881817e+00*I,
        -1.316099761542890e-02 + -7.486988277250266e-01*I,
        -1.497058998017821e-02 + -2.286440028050543e-01*I,
        -1.497058998017819e-02 + 2.286440028050544e-01*I,
        -1.316099761542887e-02 + 7.486988277250266e-01*I,
        4.838540352547806e-02 + 1.064183248881817e+00*I,
        4.827512243699522e-02 + -1.064361099906683e+00*I,
        -1.289845286651996e-02 + -7.466756423616113e-01*I,
        -1.513664865286714e-02 + -2.400897712598820e-01*I,
        -1.513664865286708e-02 + 2.400897712598818e-01*I,
        -1.289845286651992e-02 + 7.466756423616114e-01*I,
        4.827512243699511e-02 + 1.064361099906682e+00*I,
        4.816565328145389e-02 + -1.064538606750712e+00*I,
        -1.263093183538200e-02 + -7.446150874488815e-01*I,
        -1.530833394569042e-02 + -2.510567913574226e-01*I,
        -1.530833394569042e-02 + 2.510567913574225e-01*I,
        -1.263093183538208e-02 + 7.446150874488816e-01*I,
        4.816565328145359e-02 + 1.064538606750713e+00*I,
        4.805698767654148e-02 + -1.064715767551854e+00*I,
        -1.235800230964404e-02 + -7.425153109502396e-01*I,
        -1.548607381380033e-02 + -2.616109261752447e-01*I,
        -1.548607381380029e-02 + 2.616109261752444e-01*I,
        -1.235800230964410e-02 + 7.425153109502394e-01*I,
        4.805698767654164e-02 + 1.064715767551854e+00*I,
        4.794911732884713e-02 + -1.064892580546686e+00*I,
        -1.207918587769078e-02 + -7.403743110556706e-01*I,
        -1.567034233686311e-02 + -2.718060045716366e-01*I,
        -1.567034233686332e-02 + 2.718060045716368e-01*I,
        -1.207918587769087e-02 + 7.403743110556703e-01*I,
        4.794911732884698e-02 + 1.064892580546685e+00*I,
        4.784203403353374e-02 + -1.065069044067625e+00*I,
        -1.179395113315188e-02 + -7.381899190634283e-01*I,
        -1.586166652302375e-02 + -2.816868640950131e-01*I,
        -1.586166652302351e-02 + 2.816868640950129e-01*I,
        -1.179395113315195e-02 + 7.381899190634283e-01*I,
        4.784203403353354e-02 + 1.065069044067625e+00*I,
        4.773572967397224e-02 + -1.065245156540194e+00*I,
        -1.150170561229715e-02 + -7.359597796947355e-01*I,
        -1.606063437932635e-02 + -2.912914928314224e-01*I,
        -1.606063437932634e-02 + 2.912914928314225e-01*I,
        -1.150170561229728e-02 + 7.359597796947357e-01*I,
        4.773572967397303e-02 + 1.065245156540193e+00*I,
        4.763019622134155e-02 + -1.065420916480345e+00*I,
        -1.120178617476670e-02 + -7.336813283607883e-01*I,
        -1.626790453823437e-02 + -3.006525802705265e-01*I,
        -1.626790453823427e-02 + 3.006525802705263e-01*I,
        -1.120178617476668e-02 + 7.336813283607884e-01*I,
        4.763019622134157e-02 + 1.065420916480346e+00*I,
        4.752542573419761e-02 + -1.065596322491874e+00*I,
        -1.089344745891056e-02 + -7.313517647925929e-01*I,
        -1.648421780899994e-02 + -3.097986692945521e-01*I,
        -1.648421780899984e-02 + 3.097986692945518e-01*I,
        -1.089344745891052e-02 + 7.313517647925929e-01*I,
        4.752542573419709e-02 + 1.065596322491874e+00*I,
        4.742141035801038e-02 + -1.065771373263867e+00*I,
        -1.057584793844171e-02 + -7.289680223062639e-01*I,
        -1.671041112723361e-02 + -3.187550325594241e-01*I,
        -1.671041112723353e-02 + 3.187550325594242e-01*I,
        -1.057584793844175e-02 + 7.289680223062639e-01*I,
        4.742141035800989e-02 + 1.065771373263867e+00*I,
        4.731814232467398e-02 + -1.065946067568230e+00*I,
        -1.024803296765298e-02 + -7.265267318007368e-01*I,
        -1.694743451545701e-02 + -3.275443549091704e-01*I,
        -1.694743451545705e-02 + 3.275443549091706e-01*I,
        -1.024803296765295e-02 + 7.265267318007369e-01*I,
        4.731814232467435e-02 + 1.065946067568230e+00*I,
        4.721561395199621e-02 + -1.066120404257276e+00*I,
        -9.908914014602591e-03 + -7.240241793587876e-01*I,
        -1.719637185526524e-02 + -3.361872775287963e-01*I,
        -1.719637185526512e-02 + 3.361872775287960e-01*I,
        -9.908914014602574e-03 + 7.240241793587876e-01*I,
        4.721561395199619e-02 + 1.066120404257277e+00*I,
        4.711381764315214e-02 + -1.066294382261367e+00*I,
        -9.557243025932792e-03 + -7.214562560299866e-01*I,
        -1.745846652746928e-02 + -3.447028429918981e-01*I,
        -1.745846652746933e-02 + 3.447028429918982e-01*I,
        -9.557243025932777e-03 + 7.214562560299866e-01*I,
        4.711381764315185e-02 + 1.066294382261367e+00*I,
        4.701274588612703e-02 + -1.066468000586614e+00*I,
        -9.191580514781212e-03 + -7.188183979925441e-01*I,
        -1.773515332879133e-02 + -3.531088696274636e-01*I,
        -1.773515332879127e-02 + 3.531088696274641e-01*I,
        -9.191580514781151e-03 + 7.188183979925440e-01*I,
        4.701274588612617e-02 + 1.066468000586613e+00*I,
        4.691239125312913e-02 + -1.066641258312649e+00*I,
        -8.810255472178860e-03 + -7.161055147892558e-01*I,
        -1.802809856473361e-02 + -3.614222766325446e-01*I,
        -1.802809856473355e-02 + 3.614222766325447e-01*I,
        -8.810255472178889e-03 + 7.161055147892559e-01*I,
        4.691239125312898e-02 + 1.066641258312649e+00*I,
        4.681274639999342e-02 + -1.066814154590429e+00*I,
        -8.411314508521787e-03 + -7.133119026671406e-01*I,
        -1.833925091207191e-02 + -3.696593768617213e-01*I,
        -1.833925091207186e-02 + 3.696593768617214e-01*I,
        -8.411314508521730e-03 + 7.133119026671406e-01*I,
        4.681274639999332e-02 + 1.066814154590430e+00*I,
        4.671380406555448e-02 + -1.066986688640131e+00*I,
        -7.992456637269000e-03 + -7.104311391602338e-01*I,
        -1.867090663883188e-02 + -3.778361514964811e-01*I,
        -1.867090663883175e-02 + 3.778361514964813e-01*I,
        -7.992456637268946e-03 + 7.104311391602340e-01*I,
        4.671380406555458e-02 + 1.066986688640131e+00*I,
        4.661555707101469e-02 + -1.067158859749049e+00*I,
        -7.550948665521405e-03 + -7.074559538547632e-01*I,
        -1.902579421711819e-02 + -3.859685194214535e-01*I,
        -1.902579421711810e-02 + 3.859685194214525e-01*I,
        -7.550948665521522e-03 + 7.074559538547633e-01*I,
        4.661555707101484e-02 + 1.067158859749049e+00*I,
        4.651799831929023e-02 + -1.067330667269604e+00*I,
        -7.083514013325029e-03 + -7.043780686445027e-01*I,
        -1.940718550697832e-02 + -3.940726139024827e-01*I,
        -1.940718550697828e-02 + 3.940726139024832e-01*I,
        -7.083514013325030e-03 + 7.043780686445025e-01*I,
        4.651799831929028e-02 + 1.067330667269603e+00*I,
        4.642112079434602e-02 + -1.067502110617361e+00*I,
        -6.586184553015272e-03 + -7.011879985515489e-01*I,
        -1.981904391998823e-02 + -4.021650800287547e-01*I,
        -1.981904391998811e-02 + 4.021650800287545e-01*I,
        -6.586184553015285e-03 + 7.011879985515488e-01*I,
        4.642112079434595e-02 + 1.067502110617361e+00*I,
        4.632491756051577e-02 + -1.067673189269121e+00*I,
        -6.054100091651678e-03 + -6.978748011172088e-01*I,
        -2.026622493953721e-02 + -4.102634084385072e-01*I,
        -2.026622493953715e-02 + 4.102634084385071e-01*I,
        -6.054100091651709e-03 + 6.978748011172087e-01*I,
        4.632491756051626e-02 + 1.067673189269120e+00*I,
        4.622938176181798e-02 + -1.067843902761038e+00*I,
        -5.481232310908318e-03 + -6.944257581384322e-01*I,
        -2.075475218345679e-02 + -4.183863243160090e-01*I,
        -2.075475218345662e-02 + 4.183863243160093e-01*I,
        -5.481232310908222e-03 + 6.944257581384319e-01*I,
        4.622938176181830e-02 + 1.067843902761039e+00*I,
        4.613450662124816e-02 + -1.068014250686832e+00*I,
        -4.859997411097419e-03 + -6.908259677317079e-01*I,
        -2.129220476232882e-02 + -4.265542558642599e-01*I,
        -2.129220476232900e-02 + 4.265542558642601e-01*I,
        -4.859997411097277e-03 + 6.908259677317077e-01*I,
        4.613450662124831e-02 + 1.068014250686832e+00*I,
        4.604028544007392e-02 + -1.068184232695990e+00*I,
        -4.180700947637373e-03 + -6.870578169208748e-01*I,
        -2.188827244518263e-02 + -4.347899138005682e-01*I,
        -2.188827244518265e-02 + 4.347899138005680e-01*I,
        -4.180700947637434e-03 + 6.870578169208746e-01*I,
        4.604028544007400e-02 + 1.068184232695990e+00*I,
        4.594671159711826e-02 + -1.068353848492056e+00*I,
        -3.430723078781290e-03 + -6.831002949919486e-01*I,
        -2.255557041376064e-02 + -4.431190230334014e-01*I,
        -2.255557041376072e-02 + 4.431190230334021e-01*I,
        -3.430723078781329e-03 + 6.831002949919487e-01*I,
        4.594671159711819e-02 + 1.068353848492056e+00*I,
        4.585377854803124e-02 + -1.068523097830949e+00*I,
        -2.593290659295256e-03 + -6.789280967338789e-01*I,
        -2.331086717069001e-02 + -4.515712585365446e-01*I,
        -2.331086717069017e-02 + 4.515712585365453e-01*I,
        -2.593290659295140e-03 + 6.789280967338789e-01*I,
        4.585377854803113e-02 + 1.068523097830948e+00*I,
        4.576147982456155e-02 + -1.068691980519333e+00*I,
        -1.645570805614793e-03 + -6.745104574469162e-01*I,
        -2.417699097603520e-02 + -4.601814444634795e-01*I,
        -2.417699097603522e-02 + 4.601814444634794e-01*I,
        -1.645570805614805e-03 + 6.745104574469163e-01*I,
        4.576147982456170e-02 + 1.068691980519333e+00*I,
        4.566980903381825e-02 + -1.068860496413027e+00*I,
        -5.556113576485392e-04 + -6.698096763029827e-01*I,
        -2.518588938707182e-02 + -4.689910606762702e-01*I,
        -2.518588938707173e-02 + 4.689910606762698e-01*I,
        -5.556113576485021e-04 + 6.698096763029827e-01*I,
        4.566980903381823e-02 + 1.068860496413028e+00*I,
        4.557875985752827e-02 + -1.069028645415452e+00*I,
        7.227501416880014e-04 + -6.647793804779281e-01*I,
        -2.638372028019166e-02 + -4.780500048947134e-01*I,
        -2.638372028019139e-02 + 4.780500048947141e-01*I,
        7.227501416883267e-04 + 6.647793804779278e-01*I,
        4.557875985752823e-02 + 1.069028645415452e+00*I,
        4.548832605129219e-02 + -1.069196427476128e+00*I,
        2.258683210879970e-03 + -6.593629511817012e-01*I,
        -2.783964861667425e-02 + -4.874181898592075e-01*I,
        -2.783964861667405e-02 + 4.874181898592076e-01*I,
        2.258683210879991e-03 + 6.593629511817013e-01*I,
        4.548832605129184e-02 + 1.069196427476128e+00*I,
        4.539850144383507e-02 + -1.069363842589210e+00*I,
        4.160089893465421e-03 + -6.534938051079011e-01*I,
        -2.966157190754592e-02 + -4.971652824186040e-01*I,
        -2.966157190754612e-02 + 4.971652824186047e-01*I,
        4.160089893465229e-03 + 6.534938051079016e-01*I,
        4.539850144383495e-02 + 1.069363842589211e+00*I,
        4.530927993625222e-02 + -1.069530890792058e+00*I,
        6.602115133228248e-03 + -6.471035022726587e-01*I,
        -3.202463058991314e-02 + -5.073626139363371e-01*I,
        -3.202463058991298e-02 + 5.073626139363356e-01*I,
        6.602115133228263e-03 + 6.471035022726589e-01*I,
        4.530927993625222e-02 + 1.069530890792058e+00*I,
        4.522065550126018e-02 + -1.069697572163854e+00*I,
        9.875745556024133e-03 + -6.401575651426389e-01*I,
        -3.521980680983127e-02 + -5.180473774207155e-01*I,
        -3.521980680983125e-02 + 5.180473774207153e-01*I,
        9.875745556024213e-03 + 6.401575651426387e-01*I,
        4.522065550126050e-02 + 1.069697572163854e+00*I,
        4.513262218243714e-02 + -1.069863886824244e+00*I,
        1.444203859772679e-02 + -6.327763690662751e-01*I,
        -3.970815355118693e-02 + -5.291017516236539e-01*I,
        -3.970815355118693e-02 + 5.291017516236539e-01*I,
        1.444203859772713e-02 + 6.327763690662747e-01*I,
        4.513262218243705e-02 + 1.069863886824244e+00*I,
        4.504517409347022e-02 + -1.070029834932031e+00*I,
        2.083582081753152e-02 + -6.255189897275883e-01*I,
        -4.602449294987494e-02 + -5.399690666084659e-01*I,
        -4.602449294987505e-02 + 5.399690666084656e-01*I,
        2.083582081753226e-02 + 6.255189897275882e-01*I,
        4.504517409347033e-02 + 1.070029834932031e+00*I,
        4.495830541739818e-02 + -1.070195416683897e+00*I,
        2.905752103427876e-02 + -6.195093198735918e-01*I,
        -5.416924943089744e-02 + -5.495276987229319e-01*I,
        -5.416924943089855e-02 + 5.495276987229331e-01*I,
        2.905752103428026e-02 + 6.195093198735916e-01*I,
        4.495830541739795e-02 + 1.070195416683897e+00*I
    };
    const UINT D = 512;
    UINT i;
    const REAL T[2] = {0, 2*PI/0.822};
    COMPLEX *q = NULL;
    COMPLEX *spines = NULL;
    UINT K = 5;
    UINT M = 2;
    UINT points_per_spine = 100;
    UINT K_spine = K*points_per_spine;
    q = malloc(D * sizeof(COMPLEX));
    spines = malloc(K_spine * sizeof(COMPLEX));
    if (spines == NULL || q == NULL) {
        ret_code = E_NOMEM;
        goto leave_fun;
    }
    
    const REAL eps_t = (T[1]-T[0])/D;
    for (i=0; i<D; i++)
        q[i] = 1 + 0.22*CEXP(-I*0.822*(T[0]+eps_t*i));
    
    // Compute spines
    fnft_nsep_opts_t opts = fnft_nsep_default_opts();
    opts.filtering = fnft_nsep_filt_MANUAL;
    opts.bounding_box[0] = -1;
    opts.bounding_box[1] = 1;
    opts.bounding_box[2] = -2.5;
    opts.bounding_box[3] = 2.5;
    
    opts.points_per_spine = points_per_spine;
    ret_code = fnft_nsep(D, q, T, 0, &K_spine, spines, &M, NULL, NULL, +1, &opts);
    CHECK_RETCODE(ret_code, leave_fun);
    
    // Check that the spines are correct.
    // This error would be high for version 0.4.0 due to missing check on
    // Dsub being even. 
    REAL dist = misc_hausdorff_dist( 494, spines_exact,  K_spine, spines);
    if (dist > 1e-12) {
        ret_code = E_TEST_FAILED;
        goto leave_fun;
    }
    
    leave_fun:
        free(spines);
        free(q);
        return SUCCESS;
}

int main()
{
    if (fnft_nsep_test_nonregression_1() == SUCCESS)
        return EXIT_SUCCESS;
    else
        return EXIT_FAILURE;
}
