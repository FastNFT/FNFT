<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FNFT: include/private/fnft__akns_scatter.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">FNFT
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_4bd6cd521a56a9f4d924ab2d33a9895d.html">private</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">fnft__akns_scatter.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Slow forward scattering.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="fnft____akns__discretization_8h_source.html">fnft__akns_discretization.h</a>&quot;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="fnft____errwarn_8h_source.html">fnft__errwarn.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fnft____misc_8h_source.html">fnft__misc.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for fnft__akns_scatter.h:</div>
<div class="dyncontent">
<div class="center"><img src="fnft____akns__scatter_8h__incl.png" border="0" usemap="#ainclude_2private_2fnft____akns__scatter_8h" alt=""/></div>
<map name="ainclude_2private_2fnft____akns__scatter_8h" id="ainclude_2private_2fnft____akns__scatter_8h">
<area shape="rect" title="Slow forward scattering." alt="" coords="480,5,625,50"/>
<area shape="rect" href="fnft____akns__discretization_8h.html" title="Properties of the discretizations for the Korteweg&#45;de Vries equation." alt="" coords="297,98,493,126"/>
<area shape="poly" title=" " alt="" coords="512,53,434,93,432,88,509,48"/>
<area shape="rect" href="fnft____errwarn_8h.html" title=" " alt="" coords="126,174,246,201"/>
<area shape="poly" title=" " alt="" coords="480,41,385,62,334,79,286,100,242,131,208,164,204,161,239,127,283,96,332,74,383,57,479,36"/>
<area shape="rect" href="fnft____misc_8h.html" title="Miscellaneous functions used in the FNFT library." alt="" coords="502,174,603,201"/>
<area shape="poly" title=" " alt="" coords="555,50,555,158,550,158,550,50"/>
<area shape="rect" title=" " alt="" coords="561,249,632,277"/>
<area shape="poly" title=" " alt="" coords="567,49,595,104,608,138,618,173,618,206,610,236,605,234,613,205,612,174,603,140,590,106,563,52"/>
<area shape="rect" title=" " alt="" coords="678,98,744,126"/>
<area shape="poly" title=" " alt="" coords="596,48,674,88,671,93,593,53"/>
<area shape="rect" href="fnft____akns__discretization__t_8h.html" title="Lists discretizations of AKNS system." alt="" coords="270,174,478,201"/>
<area shape="poly" title=" " alt="" coords="394,127,384,160,379,159,389,125"/>
<area shape="poly" title=" " alt="" coords="358,129,238,171,236,166,357,124"/>
<area shape="poly" title=" " alt="" coords="424,124,512,165,510,169,422,129"/>
<area shape="rect" href="fnft_8h_source.html" title=" " alt="" coords="346,249,402,277"/>
<area shape="poly" title=" " alt="" coords="376,202,376,234,371,234,371,202"/>
<area shape="rect" href="fnft__config_8h_source.html" title=" " alt="" coords="322,325,425,353"/>
<area shape="poly" title=" " alt="" coords="376,278,376,310,371,310,371,278"/>
<area shape="rect" href="fnft__errwarn_8h.html" title="Controls error messages." alt="" coords="172,325,285,353"/>
<area shape="poly" title=" " alt="" coords="349,280,268,320,266,316,346,275"/>
<area shape="rect" href="fnft__numtypes_8h.html" title=" " alt="" coords="164,401,293,428"/>
<area shape="poly" title=" " alt="" coords="231,353,231,386,226,386,226,353"/>
<area shape="rect" title=" " alt="" coords="5,476,73,504"/>
<area shape="poly" title=" " alt="" coords="195,431,87,473,85,468,194,426"/>
<area shape="rect" title=" " alt="" coords="97,476,160,504"/>
<area shape="poly" title=" " alt="" coords="212,431,159,470,156,465,209,427"/>
<area shape="rect" title=" " alt="" coords="184,476,273,504"/>
<area shape="poly" title=" " alt="" coords="231,429,231,461,226,461,226,429"/>
<area shape="rect" title=" " alt="" coords="297,476,368,504"/>
<area shape="poly" title=" " alt="" coords="248,427,304,466,301,470,245,431"/>
<area shape="rect" title=" " alt="" coords="391,476,460,504"/>
<area shape="poly" title=" " alt="" coords="265,426,378,468,376,473,263,431"/>
<area shape="poly" title=" " alt="" coords="192,201,223,310,218,311,187,202"/>
<area shape="poly" title=" " alt="" coords="521,204,417,247,415,242,519,199"/>
<area shape="poly" title=" " alt="" coords="562,201,583,235,579,238,558,203"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="fnft____akns__scatter_8h__dep__incl.png" border="0" usemap="#ainclude_2private_2fnft____akns__scatter_8hdep" alt=""/></div>
<map name="ainclude_2private_2fnft____akns__scatter_8hdep" id="ainclude_2private_2fnft____akns__scatter_8hdep">
<area shape="rect" title="Slow forward scattering." alt="" coords="176,5,322,50"/>
<area shape="rect" href="fnft____kdv__scatter_8h.html" title="Slow forward scattering." alt="" coords="92,98,238,143"/>
<area shape="poly" title=" " alt="" coords="221,63,187,100,183,96,217,59"/>
<area shape="rect" href="fnft____nse__scatter_8h.html" title="Slow forward scattering." alt="" coords="304,98,450,143"/>
<area shape="poly" title=" " alt="" coords="293,57,348,95,345,100,290,61"/>
<area shape="rect" href="fnft__kdvv_8h.html" title="Fast nonlinear Fourier transform for the vanishing nonlinear Schroedinger equation." alt="" coords="8,191,154,218"/>
<area shape="poly" title=" " alt="" coords="134,155,96,192,93,188,131,151"/>
<area shape="rect" href="fnft____kdvv__testcases_8h.html" title="Provides test cases for the tests of fnft_kdvv." alt="" coords="5,266,154,311"/>
<area shape="poly" title=" " alt="" coords="83,234,83,266,77,266,78,233"/>
<area shape="rect" href="fnft__nsep_8h.html" title="Fast nonlinear Fourier transform for the periodic nonlinear Schroedinger equation." alt="" coords="179,191,324,218"/>
<area shape="poly" title=" " alt="" coords="334,153,273,192,270,188,331,148"/>
<area shape="rect" href="fnft__nsev_8h.html" title="Fast nonlinear Fourier transform for the vanishing nonlinear Schroedinger equation." alt="" coords="349,191,493,218"/>
<area shape="poly" title=" " alt="" coords="398,154,416,189,411,191,393,157"/>
<area shape="rect" href="fnft__nsev__inverse_8h.html" title="Fast inverse nonlinear Fourier transform for the vanishing nonlinear Schroedinger equation." alt="" coords="517,191,717,218"/>
<area shape="poly" title=" " alt="" coords="455,145,579,188,578,193,453,150"/>
<area shape="rect" href="fnft____nsep__testcases_8h.html" title="Provides test cases for the tests of fnft_nsep." alt="" coords="178,266,325,311"/>
<area shape="poly" title=" " alt="" coords="254,233,254,266,249,266,249,233"/>
<area shape="rect" href="fnft____nsev__testcases_8h.html" title="Provides test cases for the tests of fnft_nsev." alt="" coords="350,266,497,311"/>
<area shape="poly" title=" " alt="" coords="424,233,425,266,420,266,419,234"/>
</map>
</div>
</div>
<p><a href="fnft____akns__scatter_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4069200b200bda74eb7eee27b3a81838"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__numtype.html#gabd43adec5a7697d5307fa90ae771bb75">FNFT_INT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fnft____akns__scatter_8h.html#a4069200b200bda74eb7eee27b3a81838">fnft__akns_scatter_matrix</a> (<a class="el" href="group__numtype.html#ga7d3030b6d3b781094d3d4d50ba51bda7">FNFT_UINT</a> const D, <a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> const *const q, <a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> const *const r, <a class="el" href="group__numtype.html#gaf792e20be420583d561da21fc9cedb0d">FNFT_REAL</a> const eps_t, <a class="el" href="group__numtype.html#ga7d3030b6d3b781094d3d4d50ba51bda7">FNFT_UINT</a> const K, <a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> const *const lambda, <a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> *const result, <a class="el" href="group__numtype.html#gabd43adec5a7697d5307fa90ae771bb75">FNFT_INT</a> *const W, <a class="el" href="group__data__types.html#gaf7c714776883a98e3df072d395aa2dc1">fnft__akns_discretization_t</a> discretization, <a class="el" href="group__data__types.html#ga98007ff9d80f79fe3a33663502c256de">fnft__akns_pde_t</a> const PDE, <a class="el" href="group__numtype.html#ga7d3030b6d3b781094d3d4d50ba51bda7">FNFT_UINT</a> const vanilla_flag, <a class="el" href="group__numtype.html#ga7d3030b6d3b781094d3d4d50ba51bda7">FNFT_UINT</a> const derivative_flag)</td></tr>
<tr class="memdesc:a4069200b200bda74eb7eee27b3a81838"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the scattering matrix and its derivative.  <br /></td></tr>
<tr class="separator:a4069200b200bda74eb7eee27b3a81838"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4467325da147748cee2893e976805479"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__numtype.html#gabd43adec5a7697d5307fa90ae771bb75">FNFT_INT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fnft____akns__scatter_8h.html#a4467325da147748cee2893e976805479">akns_scatter_bound_states</a> (<a class="el" href="group__numtype.html#ga7d3030b6d3b781094d3d4d50ba51bda7">FNFT_UINT</a> const D, <a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> const *const q, <a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> const *const r, <a class="el" href="group__numtype.html#gaf792e20be420583d561da21fc9cedb0d">FNFT_REAL</a> const *const T, <a class="el" href="group__numtype.html#ga7d3030b6d3b781094d3d4d50ba51bda7">FNFT_UINT</a> const K, <a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> const *const bound_states, <a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> *const a_vals, <a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> *const aprime_vals, <a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> *const b_vals, <a class="el" href="group__numtype.html#gabd43adec5a7697d5307fa90ae771bb75">FNFT_INT</a> *Ws, <a class="el" href="group__data__types.html#gaf7c714776883a98e3df072d395aa2dc1">fnft__akns_discretization_t</a> const discretization, <a class="el" href="group__data__types.html#ga98007ff9d80f79fe3a33663502c256de">fnft__akns_pde_t</a> const PDE, <a class="el" href="group__numtype.html#ga7d3030b6d3b781094d3d4d50ba51bda7">FNFT_UINT</a> const vanilla_flag, <a class="el" href="group__numtype.html#ga7d3030b6d3b781094d3d4d50ba51bda7">FNFT_UINT</a> const skip_b_flag)</td></tr>
<tr class="memdesc:a4467325da147748cee2893e976805479"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes \(a(\lambda)\), \( a&#39;(\lambda) = \frac{\partial a(\lambda)}{\partial \lambda}\) and \(b(\lambda)\) for complex values \(\lambda\) assuming that they are very close to the true bound-states.  <br /></td></tr>
<tr class="separator:a4467325da147748cee2893e976805479"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Slow forward scattering. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a4467325da147748cee2893e976805479" name="a4467325da147748cee2893e976805479"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4467325da147748cee2893e976805479">&#9670;&#160;</a></span>akns_scatter_bound_states()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__numtype.html#gabd43adec5a7697d5307fa90ae771bb75">FNFT_INT</a> akns_scatter_bound_states </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__numtype.html#ga7d3030b6d3b781094d3d4d50ba51bda7">FNFT_UINT</a> const&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> const *const&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> const *const&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#gaf792e20be420583d561da21fc9cedb0d">FNFT_REAL</a> const *const&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#ga7d3030b6d3b781094d3d4d50ba51bda7">FNFT_UINT</a> const&#160;</td>
          <td class="paramname"><em>K</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> const *const&#160;</td>
          <td class="paramname"><em>bound_states</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> *const&#160;</td>
          <td class="paramname"><em>a_vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> *const&#160;</td>
          <td class="paramname"><em>aprime_vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> *const&#160;</td>
          <td class="paramname"><em>b_vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#gabd43adec5a7697d5307fa90ae771bb75">FNFT_INT</a> *&#160;</td>
          <td class="paramname"><em>Ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__data__types.html#gaf7c714776883a98e3df072d395aa2dc1">fnft__akns_discretization_t</a> const&#160;</td>
          <td class="paramname"><em>discretization</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__data__types.html#ga98007ff9d80f79fe3a33663502c256de">fnft__akns_pde_t</a> const&#160;</td>
          <td class="paramname"><em>PDE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#ga7d3030b6d3b781094d3d4d50ba51bda7">FNFT_UINT</a> const&#160;</td>
          <td class="paramname"><em>vanilla_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#ga7d3030b6d3b781094d3d4d50ba51bda7">FNFT_UINT</a> const&#160;</td>
          <td class="paramname"><em>skip_b_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes \(a(\lambda)\), \( a&#39;(\lambda) = \frac{\partial a(\lambda)}{\partial \lambda}\) and \(b(\lambda)\) for complex values \(\lambda\) assuming that they are very close to the true bound-states. </p>
<p>The function performs slow direct scattering and is primarily based on the references</p><ul>
<li>Boffetta and Osborne, <a href="https://doi.org/10.1016/0021-9991(92)90370-E">&quot; Computation of the direct scattering transform for the nonlinear Schroedinger equation,&quot;</a> J. Comput. Phys. 102(2), 1992.</li>
<li>Chimmalgi, Prins and Wahls, <a href="https://doi.org/10.1109/ACCESS.2019.2945480">&quot; Fast Nonlinear Fourier Transform Algorithms Using Higher Order Exponential Integrators,&quot;</a> IEEE Access 7, 2019.</li>
<li>Medvedev, Vaseva, Chekhovskoy and Fedoruk, <a href="https://doi.org/10.1364/OE.377140">&quot; Exponential fourth order schemes for direct Zakharov-Shabat problem,&quot;</a> Optics Express, vol. 28, pp. 20&ndash;39, 2020.</li>
<li>Prins and Wahls, <a href="https://doi.org/10.1109/ACCESS.2019.2932256">&quot; Soliton Phase Shift Calculation for the Korteweg–De Vries Equation,&quot;</a> IEEE Access, vol. 7, pp. 122914&ndash;122930, July 2019.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">D</td><td>Number of samples </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q</td><td>Array of length D, contains samples \( q_n\) for \(n=0,1,\dots,D-1\) in ascending order (i.e., \( q_0, q_1, \dots, q_{D-1} \)). The values should be specifically precalculated based on the chosen discretization. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r</td><td>Array of length D, contains samples \( r_n\) for \(n=0,1,\dots,D-1\) in ascending order (i.e., \( r_0, r_1, \dots, r_{D-1} \)). The values should be specifically precalculated based on the chosen discretization. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">T</td><td>Array of length 2, contains the position in time of the first and of the last sample. It should be T[0]&lt;T[1]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">K</td><td>Number of bound-states. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bound_states</td><td>Array of length K, contains the bound-states \(\lambda\). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">a_vals</td><td>Array of length K, contains the values of \(a(\lambda)\). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">aprime_vals</td><td>Array of length K, contains the values of \( a&#39;(\lambda) = \frac{\partial a(\lambda)}{\partial \lambda}\). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">b_vals</td><td>Array of length K, contains the values of \(b(\lambda)\). The \(b(\lambda)\) are calculated using the criterion from Prins and Wahls, <a href="https://doi.org/10.1109/ACCESS.2019.2932256">&quot; Soliton Phase Shift Calculation for the Korteweg–De Vries Equation,&quot;</a>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Ws</td><td>Pass an array of size K. Upon exit, it contains scaling factors that arise due to an internal normalization of the scattering process (to deal with potential overflow issues). The returned values for a and a_prime still have to be multiplied with corresponding power of two (i.e. POW(2, Ws[i])) to obtain the final values. Note that this is not required for the values of b. No normalization is carried out if NULL is passed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">discretization</td><td>The type of discretization to be used. Should be of type <a class="el" href="group__data__types.html#gaf7c714776883a98e3df072d395aa2dc1">fnft__akns_discretization_t</a>. Not all akns_discretization_t discretizations are supported. Check <a class="el" href="group__data__types.html#gac7910f5e26ab68217ed7d6565c539d1b">fnft_nse_discretization_t</a> for list of supported types. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PDE</td><td>The partial differential equation for which the calculation has to be done. Should be of type <a class="el" href="group__data__types.html#ga98007ff9d80f79fe3a33663502c256de">fnft__akns_pde_t</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vanilla_flag</td><td>For calculations for the KdV equation, pass 1 for the original mapping to the AKNS framework with r=-1. Pass 0 for the alternative mapping with q=-1. Unused for NSE. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">skip_b_flag</td><td>If set to 1 the routine will not compute \(b(\lambda)\). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__errwarn.html#gaf81fba4f4c17239667bfd4d9cc6152a3">FNFT_SUCCESS</a> or one of the FNFT_EC_... error codes defined in <a class="el" href="fnft__errwarn_8h.html">fnft_errwarn.h</a>. </dd></dl>

</div>
</div>
<a id="a4069200b200bda74eb7eee27b3a81838" name="a4069200b200bda74eb7eee27b3a81838"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4069200b200bda74eb7eee27b3a81838">&#9670;&#160;</a></span>fnft__akns_scatter_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__numtype.html#gabd43adec5a7697d5307fa90ae771bb75">FNFT_INT</a> fnft__akns_scatter_matrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__numtype.html#ga7d3030b6d3b781094d3d4d50ba51bda7">FNFT_UINT</a> const&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> const *const&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> const *const&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#gaf792e20be420583d561da21fc9cedb0d">FNFT_REAL</a> const&#160;</td>
          <td class="paramname"><em>eps_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#ga7d3030b6d3b781094d3d4d50ba51bda7">FNFT_UINT</a> const&#160;</td>
          <td class="paramname"><em>K</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> const *const&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#gaa5ac1a0d191809dde56bb16ba117cb79">FNFT_COMPLEX</a> *const&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#gabd43adec5a7697d5307fa90ae771bb75">FNFT_INT</a> *const&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__data__types.html#gaf7c714776883a98e3df072d395aa2dc1">fnft__akns_discretization_t</a>&#160;</td>
          <td class="paramname"><em>discretization</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__data__types.html#ga98007ff9d80f79fe3a33663502c256de">fnft__akns_pde_t</a> const&#160;</td>
          <td class="paramname"><em>PDE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#ga7d3030b6d3b781094d3d4d50ba51bda7">FNFT_UINT</a> const&#160;</td>
          <td class="paramname"><em>vanilla_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numtype.html#ga7d3030b6d3b781094d3d4d50ba51bda7">FNFT_UINT</a> const&#160;</td>
          <td class="paramname"><em>derivative_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the scattering matrix and its derivative. </p>
<p>The function computes the scattering matrix and the derivative of the scattering matrix with respect to \(\lambda\). The function performs slow direct scattering and is primarily based on the reference Boffetta and Osborne (<a href="http://dx.doi.org/10.1016/0021-9991(92)90370-E">J. Comput. Physics 1992 </a>).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">D</td><td>Number of samples </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q</td><td>Array of length D, contains samples \( q_n\) for \(n=0,1,\dots,D-1\) in ascending order (i.e., \( q_0, q_1, \dots, q_{D-1} \)). The values should be specifically precalculated based on the chosen discretization. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">r</td><td>Array of length D, contains samples \( r_n\) for \(n=0,1,\dots,D-1\) in ascending order (i.e., \( r_0, r_1, \dots, r_{D-1} \)). The values should be specifically precalculated based on the chosen discretization. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eps_t</td><td>Step-size, eps_t \(= (T[1]-T[0])/(D-1) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">K</td><td>Number of values of \(\lambda\). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lambda</td><td>Array of length K, contains the values of \(\lambda\). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">result</td><td>Array of length K*8 or K*4, If derivative_flag=0 returns [S11(lambda[0]) S12(lambda[0]) S21(lambda[0]) S22(lambda[0]) S11(lambda[1]) ... S22(lambda[K-1]] in result where S = [S11, S12; S21, S22] is the scattering matrix computed using the chosen discretization. If derivative_flag=1 returns [S11 S12 S21 S22 S11' S12' S21' S22'] in result where S11' is the derivative of S11 w.r.t to \(\lambda\). Should be preallocated with size 4*K or 8*K accordingly. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">W</td><td>Pass an array of size K. Upon exit, it contains scaling factors that arise due to an internal normalization of the scattering matrix (to deal with potential overflow issues). The result has to be scaled by the power of 2 to obtain the final values. No normalization is carried out if NULL is passed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">discretization</td><td>The type of discretization to be used. Should be of type <a class="el" href="group__data__types.html#gaf7c714776883a98e3df072d395aa2dc1">fnft__akns_discretization_t</a>. Not all akns_discretization_t discretizations are supported. Check <a class="el" href="group__data__types.html#gaf7c714776883a98e3df072d395aa2dc1">fnft__akns_discretization_t</a> for list of supported types. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PDE</td><td>Partial differential equation of type <a class="el" href="group__data__types.html#ga98007ff9d80f79fe3a33663502c256de">fnft__akns_pde_t</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vanilla_flag</td><td>For calculations for the KdV equation, pass 1 for the original mapping to the AKNS framework with r=-1. Pass 0 for the alternative mapping with q=-1. Unused for NSE. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">derivative_flag</td><td>Should be set to either 0 or 1. If set to 1 the derivatives [S11' S12' S21' S22'] are calculated. result should be preallocated with size 8*K if flag is set to 1. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="group__errwarn.html#gaf81fba4f4c17239667bfd4d9cc6152a3">FNFT_SUCCESS</a> or one of the FNFT_EC_... error codes defined in <a class="el" href="fnft__errwarn_8h.html">fnft_errwarn.h</a>. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
